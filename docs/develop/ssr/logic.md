# Логика рендера

Для серверного рендера используется другой входной файл `index.node.js`. Его логика схожа с `index.web.js`. 
Но вместо монтирования приложения к DOM узлу вызывается рендер приложения в строку функцией renderToString(jsx).

Перед тем как рендерить надо инициализировать состояние, запросить и дождаться всех данных, которые нужны текущей странице. 
Чтобы в архитектуру приложения не вносить отдельные слои инициализации, и не выносить роутинг на jsx в отдельные конфиги 
(надо как-то узнать что будет рендериться - кто будет запрашивать начальные данные). 
Вся подготовительная операция выполняется через предварительный рендер. При первом рендере компоненты запросят данные. 
При втором рендере уже отрендерятся с готовым состоянием. 

Промисы инициализации при первом рендере перехватываются и добавляются в массив. Далее ожидается когда они все выполнятся. 
При повторном рендере понимают, что это второй рендер и им уже не надо выполнять инициализацию. 
Логика инициализации, перехвата промисов и проверки первого рендера реализуются в хуке useInit(). 
На фронте она тоже учитывается, чтобы не было инициализации, если есть начальное состояние от SSR.  

Рендер приложения вставляется в шаблон html. Кроме того в шаблон нужно вставить метданные. Заголовок, описание, ключевые 
слова и другие мета теги определяются библиотекой helmet Она же используется в разметке компонентов для установки метаданных. 

Стили и скрипты с учетом деления сборок на чанки и других особенностей сборки узнаются библиотекой loadable-components
